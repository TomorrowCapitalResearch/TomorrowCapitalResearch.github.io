<!-- ===== Tomorrow Shared Header (HTML+CSS+JS) ===== -->

<style>
*{box-sizing:border-box}
  html,body{margin:0;padding:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:#ffffff}

:root{
  --white:#ffffff; /* White */
  --black:#000000; /* Black */

  /* Primary colors */
  --lb: #DCEAF7; /* Light Blue*/
  --blue:#61CBF4; /* Blue */
  --footer: #CAEEFB; /* footer blue */

  /* Secondary colors */
  --db:#0E3275;  /* Deep Blue */
  --contrast:#0A1D45;   /* Contrast elements Grey */
  --text:#156082;
  --texthover:#0F9ED5;
  --brand-blue:#153E9F;          /* Citadel-like deep blue */
  --ink:#0A0A0A;
  --muted:#2A2A2A;
  --card:#F1EFED;                 /* Rothschild-like warm grey card */
  --paper:#FFFFFF;
  --gold:#C59B3B;                 /* optional accent for chevrons/links */

  
  /*geometrics*/
  --page-max: 1200px;
  --side-pad: 24px;
  --hero-image: url("assets/A1.jpeg");
  --radius:14px;  
  }

/* Navbar basics you already have */
.nav{position:sticky; top:0; z-index:1000; background:#ffffff; border-bottom:1px solid rgba(0,0,0,.06)}
.nav-inner{max-width:100%; margin:auto; padding:20px 20px; display:flex; align-items:center; justify-content:space-between}
.menu{display:flex; gap:12px; align-items:center}
.menu .menu-trigger, .menu .menu-link{
  font:500 16px/1.2 "Inter", sans-serif;
  color:var(--text);
  background:none; border:0; padding:30px 10px; cursor:pointer;
  text-decoration:none;
}

.menu .menu-trigger:hover, .menu .menu-link:hover{
  color:var(--texthover);
  text-decoration:underline;
  text-decoration-color:var(--texthover);
  text-decoration-thickness:3px;
  text-underline-offset:5px;
}

.mega{
  position:absolute; left:0; right:0; top:0;  /* JS sets top dynamically */
  display:none; isolation:isolate; z-index:900;
}
    
.mega.open{ display:block; }

.mega-panel{
  display: none;
  width: 100%;
  min-height:280px;
  background: linear-gradient(to right, var(--blue), var(--lb));
  color:var(--text);
  border-top:1px solid rgba(125,125,125,.5);
  box-shadow:0 40px 40px rgba(10,29,69,.35);
  padding:40px 30px;
  grid-template-columns: 1fr auto 3fr; /* left | divider | right */
  align-items: start;              /* vertical alignment for left/right */
  column-gap: 40px;
}
    
.mega-panel.open{ display:grid; }
    
.divider {
  grid-column: 2;
  width: 1px;
  background-color: rgba(255, 255, 255, 1); /* subtle line */
  align-self:stretch;
  margin-block: 10px;  
}
    
.mega-left{ grid-column:1; display:flex; flex-direction:column; justify-content:flex-start; align-items:flex-start; gap:30px; padding-block:5px; }
.mega-left h2{
  margin: 0;
  font-family: "Inter", sans-serif;
  font-weight: 500;                                   /* lighter */
  font-size: 40px;                  /* big & responsive */
  line-height: 1.05;
  letter-spacing: 0.2px;                              /* slightly open */
  color: var(--text);                                        /* white */
}
  
.mega-left .btn{
  display:inline-flex;
  justify-content:center;
  align-items: center;
  gap: 10px;
  padding:12px 16px;
  border-radius:9999px; 
  font-family: "Inter", sans-serif;
  font-weight: 500;
  font-size: 18px;
  text-decoration:none;
  
  background:var(--white); 
  color:var(--text);
}
    
.mega-right{ grid-column:3; display:flex; justify-content:left; }
#mega-research .mega-right ul,
#mega-wwd .mega-right ul{
  display: grid;
  grid-template-columns: repeat(2, minmax(220px, 1fr));
  column-gap: 48px;   /* space between the columns */
  row-gap: 12px;      /* space between items */
  align-content: start;
}

#mega-research .mega-right li,
#mega-wwd .mega-right li{
  margin: 0; /* grid handles spacing */
}

    
.mega-right ul{ display:flex; flex-direction:column; list-style: none; gap:0px; margin:0; padding:0; }
.mega-right li{ margin: 5px 0; }

.mega-right a{
  display: inline-block;
  padding: 6px 2px;  /* a little hit area */
  color: var(--text);
  font: 500 16px/1 "Inter", sans-serif;
  text-decoration: none;
  transition: color .15s ease, filter .15s ease, text-decoration-color .15s;
}

.mega-right a:hover,
.mega-right a:focus-visible{
  color: var(--texthover);
  filter: brightness(1.2);            /* subtle brighten */
  text-decoration: underline;
  text-decoration-thickness: 2px;
  text-underline-offset: 4px;
}

/* Close button (X) */
.mega-close{
  position:absolute; top:16px; right:24px;
  background:transparent; border:0; color:#ffffff; font-size:40px; line-height:1; cursor:pointer;
}
.mega-close:hover{ opacity:1 }

body{position:relative}

  .brand {
  display: flex;
  align-items: center;
  gap: 10px;       
  pointer-events: none; 
}

.brand img {
  height: 40px;   
  width: auto;
}

.brand-text {
  font-family: "Inter", sans-serif;   /* ensures Arial is used */
  font-size:48px;                   /* adjust to preferred size */
  letter-spacing:-1px;              /* pulls characters closer together */
  color:var(--text);                    /* same blue as your logo */
  line-height:1;                    /* ensures text sits nicely next to logo */
  user-select:none;
}

.brand span {
  color: var(--text);
  font-size: 48px;
  letter-spacing:-1px;
  line-height: 1;
}
</style>

<header class="nav">
  <div class="nav-inner">
    <div class="brand">
    <img src="https://tomorrowcapitalresearch.github.io/assets/logo.png" alt="Tomorrow Capital Research logo">
    <span class="brand-text">Tomorrow</span>
    </div>

    <nav class="menu" aria-label="Primary">
      <button class="menu-trigger" data-panel="mega-wwa" aria-haspopup="true" aria-expanded="false">Who We Are</button>
      <button class="menu-trigger" data-panel="mega-wwd" aria-haspopup="true" aria-expanded="false">What We Do</button>
      <button class="menu-trigger" data-panel="mega-news" aria-haspopup="true" aria-expanded="false">What Is New</button>
      <button class="menu-trigger" data-panel="mega-research" aria-haspopup="true" aria-expanded="false">Research</button>
      <button class="menu-trigger" data-panel="mega-careers" aria-haspopup="true" aria-expanded="false">How To Join</button>
      <a class="menu-link" href="https://tomorrowcapitalresearch.github.io/contact.html">Contact</a>
      <a class="menu-link" href="https://tomorrowcapitalresearch.github.io/investors.html">Investors page</a>
    </nav>
  </div>

<!-- MEGA DROPDOWN AREA -->
<div class="mega" id="mega-root" aria-live="polite">
  <!-- Who We Are Panel -->
  <section id="mega-wwa" class="mega-panel" role="dialog" aria-label="Who We Are menu" aria-modal="false">
    <button class="mega-close" aria-label="Close menu">×</button>
    <div class="mega-left">
      <h2>Who We Are</h2>
      <a class="btn" href="https://tomorrowcapitalresearch.github.io/who-we-are.html">Learn More</a>
      
    </div>  
    <div class="divider"></div>
    <div class="mega-right">
      <ul>
        <li><a href="https://tomorrowcapitalresearch.github.io/mission.html">Mission, Vision & Values</a></li>
        <li><a href="https://tomorrowcapitalresearch.github.io/team.html">Culture & Philosophy</a></li>
        <li><a href="https://tomorrowcapitalresearch.github.io/team.html">Notable Employees</a></li>
        <li><a href="https://tomorrowcapitalresearch.github.io/life-at-tmrw.html">Life at Tomorrow</a></li>
      </ul>
    </div>
  </section>

  <!-- What We Do panel -->
  <section id="mega-wwd" class="mega-panel" role="dialog" aria-label="What We Do menu" aria-modal="false">
    <button class="mega-close" aria-label="Close menu">×</button>
    <div class="mega-left">
      <h2>What We Do</h2>
      <a class="btn" href="https://tomorrowcapitalresearch.github.io/what-we-do.html">Learn More</a>
      
    </div>  
    <div class="divider"></div>
    <div class="mega-right">
      <ul>
        <li><a href="https://tomorrowcapitalresearch.github.io/test.html">Trading Framework</a></li>
        <li><a href="https://tomorrowcapitalresearch.github.io/test.html">Risk & Research Principles</a></li>
        <li><a href="https://tomorrowcapitalresearch.github.io/test.html">Portfolio Architecture</a></li>
        <li><a href="https://tomorrowcapitalresearch.github.io/test.html">Technology & Infrastructure</a></li>
        <li><a href="https://tomorrowcapitalresearch.github.io/test.html">Business Strategy</a></li>
        <li><a href="https://tomorrowcapitalresearch.github.io/test.html">Execution & Microstructure</a></li>
        <li><a href="https://tomorrowcapitalresearch.github.io/test.html">Impact & Partnerships</a></li>
      </ul>
    </div>
  </section>

    <!-- What Is New panel -->
  <section id="mega-news" class="mega-panel" role="dialog" aria-label="What Is New menu" aria-modal="false">
    <button class="mega-close" aria-label="Close menu">×</button>
    
    <div class="mega-left">
      <h2>What Is New</h2>
      <a class="btn" href="https://tomorrowcapitalresearch.github.io/news.html">Learn More</a>
    </div>
    <div class="divider"></div>
    <div class="mega-right">
      <ul>
        <li><a href="https://tomorrowcapitalresearch.github.io/corp.html">Corporate News</a></li>
        <li><a href="https://tomorrowcapitalresearch.github.io/tech-blog.html">Tech Blog</a></li>
        <li><a href="https://tomorrowcapitalresearch.github.io/research-blog.html">Research Blog</a></li>
      </ul>
    </div>
  </section>

  <!-- Research panel -->
  <section id="mega-research" class="mega-panel" role="dialog" aria-label="Research menu" aria-modal="false">
    <button class="mega-close" aria-label="Close menu">×</button>
    
    <div class="mega-left">
      <h2>Research</h2>
      <a class="btn" href="https://tomorrowcapitalresearch.github.io/research.html">Learn More</a>
    </div>
    <div class="divider"></div>
    <div class="mega-right">
      <ul>
        <li><a href="https://tomorrowcapitalresearch.github.io/signals.html">Signals & Forecasting</a></li>
        <li><a href="https://tomorrowcapitalresearch.github.io/portfolio.html">Portfolio & Control Theory</a></li>
        <li><a href="https://tomorrowcapitalresearch.github.io/execution.html">Execution & Microstructure</a></li>
        <li><a href="https://tomorrowcapitalresearch.github.io/notes.html">Quantitative Finance Library</a></li>
        <li><a href="https://tomorrowcapitalresearch.github.io/notes.html">Whitepapers, notes and Research Statements</a></li>
        <li><a href="https://tomorrowcapitalresearch.github.io/notes.html">External Proposals</a></li>
        <li><a href="https://tomorrowcapitalresearch.github.io/notes.html">Open Problems & Prize Program</a></li>
      </ul>
    </div>
  </section>

  <!-- How To Join panel -->
  <section id="mega-careers" class="mega-panel" role="dialog" aria-label="How To Join menu" aria-modal="false">
    <button class="mega-close" aria-label="Close menu">×</button>
    
    <div class="mega-left">
      <h2>How To Join</h2>
      <a class="btn" href="https://tomorrowcapitalresearch.github.io/careers.html">Open Positions</a>
    </div>
    <div class="divider"></div>
    <div class="mega-right">
      <ul>
        <li><a href="https://tomorrowcapitalresearch.github.io/life-at-tmrw.html">Life at Tomorrow</a></li>
        <li><a href="https://tomorrowcapitalresearch.github.io/careers.html">Experienced Candidates</a></li>
        <li><a href="https://tomorrowcapitalresearch.github.io/careers.html">Internships</a></li>
        <li><a href="https://tomorrowcapitalresearch.github.io/find-your-place.html">Find Your Place</a></li>
      </ul>
    </div>
  </section>
</div>
</header>


<script>
  const yearEl = document.getElementById('year');
  if (yearEl) yearEl.textContent = new Date().getFullYear();


  const nav     = document.querySelector('.nav');
  const menu    = document.querySelector('.menu');
  const root    = document.getElementById('mega-root');
  const triggers= document.querySelectorAll('.menu .menu-trigger');
  const panels  = document.querySelectorAll('.mega-panel');

  // If navbar height changes (responsive), keep the panel snug under it
  const placeMega = () => {
    const navRect = nav.getBoundingClientRect();
    root.style.top = `${navRect.height}px`;
  };
  placeMega();
  window.addEventListener('resize', placeMega);

  let hoverCloseTimer = null;

  function openPanel(id){
    root.classList.add('open');
    panels.forEach(p => p.classList.toggle('open', p.id === id));
    triggers.forEach(t => t.setAttribute('aria-expanded', String(t.dataset.panel === id)));
  }

  function closeAll(){
    root.classList.remove('open');
    panels.forEach(p => p.classList.remove('open'));
    triggers.forEach(t => t.setAttribute('aria-expanded','false'));
  }

  // Open/switch on hover or click
  triggers.forEach(btn => {
    const id = btn.dataset.panel;
    btn.addEventListener('mouseenter', () => openPanel(id));
    btn.addEventListener('click', (e) => { e.preventDefault(); openPanel(id); });
    // Keyboard accessibility: open when focused with Tab
    btn.addEventListener('focus', () => openPanel(id));
  });

  // Close with the X
  root.addEventListener('click', (e) => {
    if (e.target.closest('.mega-close')) closeAll();
  });

  // Close on Escape
  document.addEventListener('keydown', (e) => { if (e.key === 'Escape') closeAll(); });

  // Helper: are we hovering inside nav or mega?
  const isInsideHoverZone = (event) => {
    const insideNav  = event.relatedTarget && (event.relatedTarget === nav || nav.contains(event.relatedTarget));
    const insideMega = event.relatedTarget && (event.relatedTarget === root || root.contains(event.relatedTarget));
    return insideNav || insideMega;
  };

  // Start a short timer when leaving nav or panel; cancel if the pointer enters the other region
  const startCloseTimer = () => {
    clearTimeout(hoverCloseTimer);
    hoverCloseTimer = setTimeout(() => {
      // If the pointer is not over nav or mega when timer fires, close.
      const hovered = document.querySelector(':hover');
      const overNav  = hovered && (hovered === nav || nav.contains(hovered));
      const overMega = hovered && (hovered === root || root.contains(hovered));
      if (!overNav && !overMega) closeAll();
    }, 120); // small delay prevents flicker during the gap between elements
  };

  // Leave handlers for both zones
  nav.addEventListener('mouseleave', (e) => { if (!isInsideHoverZone(e)) startCloseTimer(); });
  root.addEventListener('mouseleave', (e) => { if (!isInsideHoverZone(e)) startCloseTimer(); });

  // Entering either zone cancels any pending close
  nav.addEventListener('mouseenter', () => clearTimeout(hoverCloseTimer));
  root.addEventListener('mouseenter', () => clearTimeout(hoverCloseTimer));

  // Optional: clicking anywhere outside both zones closes it
  document.addEventListener('click', (e) => {
    if (!e.target.closest('.mega') && !e.target.closest('.menu')) closeAll();
  });

  // Touch support: tap a trigger toggles its panel; tap outside closes
  // (prevents immediate navigation on mobile when you want to open the panel)
  triggers.forEach(btn => {
    btn.addEventListener('touchstart', (e) => {
      const id = btn.dataset.panel;
      const alreadyOpen = root.classList.contains('open') && document.getElementById(id).classList.contains('open');
      if (!alreadyOpen) {
        e.preventDefault();
        openPanel(id);
      }
    }, {passive:false});
  });
</script>

<!-- ===== /Tomorrow Shared Header ===== -->

<script>
(function(){
  const nav  = document.querySelector('.nav');
  const root = document.getElementById('mega-root');
  const triggers = document.querySelectorAll('.menu .menu-trigger');
  const panels   = document.querySelectorAll('.mega-panel');
  if (!nav || !root || !triggers.length || !panels.length) return;

  const placeMega = () => {
    const h = nav.getBoundingClientRect().height || 0;
    root.style.top = h + 'px';
  };
  placeMega(); addEventListener('resize', placeMega);

  function openPanel(id){ root.classList.add('open'); panels.forEach(p=>p.classList.toggle('open', p.id===id)); triggers.forEach(t=>t.setAttribute('aria-expanded', String(t.dataset.panel===id))); }
  function closeAll(){ root.classList.remove('open'); panels.forEach(p=>p.classList.remove('open')); triggers.forEach(t=>t.setAttribute('aria-expanded','false')); }

  triggers.forEach(btn => {
    const id = btn.dataset.panel;
    btn.addEventListener('mouseenter', () => openPanel(id));
    btn.addEventListener('click', e => { e.preventDefault(); openPanel(id); });
    btn.addEventListener('focus', () => openPanel(id));
  });
  root.addEventListener('click', e => { if (e.target.closest('.mega-close')) closeAll(); });
  addEventListener('keydown', e => { if (e.key === 'Escape') closeAll(); });
})();
</script>

